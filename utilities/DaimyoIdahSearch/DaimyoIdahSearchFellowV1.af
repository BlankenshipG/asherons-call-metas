~~ {
~~ FOR AUTO-COMPLETION ASSISTANCE: testvar getvar setvar touchvar clearallvars clearvar getcharintprop getchardoubleprop getcharquadprop getcharboolprop getcharstringprop getisspellknown getcancastspell_hunt getcancastspell_buff getcharvital_base getcharvital_current getcharvital_buffedmax getcharskill_traininglevel getcharskill_base getcharskill_buffed getplayerlandcell getplayercoordinates coordinategetns coordinategetwe coordinategetz coordinatetostring coordinateparse coordinatedistancewithz coordinatedistanceflat wobjectgetphysicscoordinates wobjectgetname wobjectgetobjectclass wobjectgettemplatetype wobjectgetisdooropen wobjectfindnearestmonster wobjectfindnearestdoor wobjectfindnearestbyobjectclass wobjectfindininventorybytemplatetype wobjectfindininventorybyname wobjectfindininventorybynamerx wobjectgetselection wobjectgetplayer wobjectfindnearestbynameandobjectclass actiontryselect actiontryuseitem actiontryapplyitem actiontrygiveitem actiontryequipanywand actiontrycastbyid actiontrycastbyidontarget chatbox chatboxpaste statushud statushudcolored uigetcontrol uisetlabel isfalse istrue iif randint cstr strlen getobjectinternaltype cstrf stopwatchcreate stopwatchstart stopwatchstop stopwatchelapsedseconds cnumber floor ceiling round abs getworldname getitemcountininventorybyname getheading getitemcountininventorybynamerx getheadingto actiontrygiveprofile vitae getfellowshipstatus getfellowshipname getfellowshipisopen getfellowshipisleader getfellowshipleaderid getfellowshipcanrecruit getfellowid getfellowshipcount getfellowshiplocked getfellowname getfellowshipisfull sin cos tan sqrt asin acos atan atan2 sinh cosh tanh vtsetmetastate getregexmatch echo chr ord wobjectgetid wobjectgethealth wobjectfindbyid wobjectgetintprop wobjectfindnearestbytemplatetype wobjectgetopencontainer testquestflag getquestktprogress isrefreshingquests getquestktrequired getqueststatus getisday getgamehour getgamehourname getisnight getgameday getgameticks getminutesuntilday getgamemonth getgamemonthname getminutesuntilnight getgameyear uisetvisible uiviewvisible uiviewexists getgvar touchgvar getpvar touchpvar setgvar cleargvar setpvar clearpvar testgvar clearallgvars testpvar clearallpvars dictgetitem dictcreate dicthaskey dictadditem dictkeys dictremovekey dictvalues dictclear dictsize dictcopy listgetitem listpop listcreate listcontains listremove listadd listindexof listremoveat listinsert listlastindexof listclear listcopy listcount listreverse

~~																						
~~ File auto-generated by metaf, a program created by Eskarina of Morningthaw/Coldeve.	
~~		Get metaf here: https://github.com/JJEII/metaf/									
~~																						
~~ All recognized structural designators:												
~~		STATE:				DO:															
~~		IF:					NAV:														
~~																						
~~ All recognized CONDITION (IF:) operation keywords:									
~~		Never				NavEmpty			MobsInDist_Priority		Not				
~~		Always				Death				NeedToBuff				PSecsInStateGE	
~~		All					VendorOpen			NoMobsInDist			SecsOnSpellGE	
~~		Any					VendorClosed		BlockE					BuPercentGE		
~~		ChatMatch			ItemCountLE			CellE					DistToRteGE		
~~		MainSlotsLE			ItemCountGE			IntoPortal				Expr			
~~		SecsInStateGE		MobsInDist_Name		ExitPortal				ChatCapture		
~~																						
~~ All recognized ACTION (DO:) operation keywords:										
~~		None				EmbedNav			ChatExpr				SetOpt			
~~		SetState			CallState			SetWatchdog				CreateView		
~~		Chat				Return				ClearWatchdog			DestroyView		
~~		DoAll				DoExpr				GetOpt					DestroyAllViews	
~~																						
~~ All recognized NAV types:															
~~		circular			follow														
~~		linear				once														
~~																						
~~ All recognized NAV NODE types:														
~~		flw					vnd															
~~		pnt					ptl															
~~		rcl					tlk															
~~		pau					chk															
~~		cht					jmp															
~~		prt (deprecated in VTank)														
~~ }																

STATE: {Default} ~~ {
	IF: Expr {getfellowshipstatus[]==0}
		DO: DoAll
				DoExpr {echo[Not in a fellowship\!,15]}
				SetState {WaitingForFellowship}
	IF:	Expr {getfellowshipstatus[]!=0}
		DO:	SetState {Settings}		
~~ }
STATE: {WaitingForFellowship} ~~ {
	IF: Expr {getfellowshipstatus[]==1}
		DO: SetState {Default}
~~ } 
STATE: {Settings} ~~ {
	IF:	Always
		DO:	DoAll
				Chat {/ub opt set VTank.PatchExpressionEngine True}
				DoExpr {vtsetsetting[NavCloseStopRange,`0.00625`]} ~~ 1.5
				DoExpr {vtsetsetting[NavPriorityBoost,`0`]}
				DoExpr {vtsetsetting[EnableBuffing,`1`]}
				DoExpr {vtsetsetting[EnableCombat,`0`]}
				DoExpr {vtsetsetting[EnableNav,`1`]}
				DoExpr {vtsetsetting[IdlePeaceMode,`0`]}
				DoExpr {vtsetsetting[EnableLooting,`1`]}
				DoExpr {vtsetsetting[LootOnlyRareCorpses,`1`]}
				DoExpr {vtsetsetting[StopMacroOnDeath,`0`]}
				DoExpr {uboptset[`VTank.FixPortalLoops`,True]}
				DoExpr {vtsetsetting[UseDispelItems,`1`]}  
				DoExpr {vtsetsetting[AutoAttackPower,`1`]}
				DoExpr {vtsetsetting[BlacklistMonsterTimeoutSeconds,`30`]}
				DoExpr {vtsetsetting[Recharge-Notarg-Hitp,`0`]}
				DoExpr {vtsetsetting[Recharge-Norm-Hitp,`70`]} 
				DoExpr {vtsetsetting[Recharge-Norm-Stam,`5`]}
				DoExpr {vtsetsetting[Recharge-Norm-Mana,`15`]}
				DoExpr {vtsetsetting[Recharge-Notarg-Hitp,`0`]}
				DoExpr {vtsetsetting[Recharge-Notarg-Stam,`0`]}
				DoExpr {vtsetsetting[Recharge-Notarg-Mana,`50`]}
				DoExpr {vtsetsetting[OpenDoors,`0`]}
				DoExpr {vtsetsetting[SummonPets,`1`]}
				DoExpr {vtsetsetting[PetRangeMode,`1`]}
				DoExpr {vtsetsetting[PetCustomRange,`0.0625`]} ~~ 15
				DoExpr {vtsetsetting[AttackDistance,`0.0125`]} ~~ 3
				DoExpr {vtsetsetting[ApproachDistance,`0.0125`]} ~~ 3	
	IF: SecsInStateGE 3
		DO: SetState {Begin}			
~~ }
STATE: {Begin} ~~ {
	IF: Always
		DO: DoAll
				DoExpr {echo[Daimyo Idah Search Meta by Sun Invictus,15]}
				DoExpr {echo[Expects VTank Monster tab to be configured for quest,15]}
	IF: All 
			Not NeedToBuff
			SecsInStateGE 5
		DO: SetState {NightTimeCheck}
~~ }
STATE: {NightTimeCheck} ~~ {
	IF: All 
			Expr {getisnight[]==1}
			Not CellE 48E0000E
		DO: CallState {CheckForTownNetworkDrop} {NavigatingToWoodshoreCottages}
	IF: All 
			Expr {getisnight[]==1}
			CellE 48E0000E
		DO: SetState {GroupUp}
	IF: Expr {getisnight[]==0}
		DO: SetState {WaitingForNight}
~~ }
STATE: {WaitingForNight} ~~ {
	IF: Always
		DO: ChatExpr {\/f Daimyo Idah only spawns at night\.  Waiting +getminutesuntilnight[]+ \ minutes until night\.}
	IF: Expr {getisday[]==0}
		DO: SetState {NightTimeCheck}
~~ }
STATE: {CheckForTownNetworkDrop} ~~ {
	IF: CellE 00070145 ~~ Annex TN drop
		DO: Return
	IF: CellE 00070133 ~~ Gharu'ndim TN drop
		DO: SetState {NavigatingFromGharuToAnnexDrop}
	IF: CellE 00070143 ~~ Aluvian TN drop
		DO: SetState {NavigatingFromAluvianToAnnexDrop}
	IF: CellE 00070156 ~~ Sho TN drop
		DO: SetState {NavigatingFromShoToAnnexDrop}
	IF: All
			Not CellE 00070145
			Not CellE 00070133
			Not CellE 00070143
			Not CellE 00070156
		DO: SetState {AttemptPrimaryRecallToTownNetwork}
~~ }
STATE: {NavigatingFromGharuToAnnexDrop} ~~ {
	IF: Always
		DO: EmbedNav nav1 {TNGharuToAnnex.nav}
	IF: All
			NavEmpty
			SecsInStateGE 3
		DO: SetState {CheckForTownNetworkDrop}
~~ }
STATE: {NavigatingFromAluvianToAnnexDrop} ~~ {
	IF: Always
		DO: EmbedNav nav2 {TNAluvianToAnnex.nav}
	IF: All
			NavEmpty
			SecsInStateGE 3
		DO: SetState {CheckForTownNetworkDrop}
~~ }
STATE: {NavigatingFromShoToAnnexDrop} ~~ {
	IF: Always
		DO: EmbedNav nav3 {TNShoToAnnex.nav}
	IF: All
			NavEmpty
			SecsInStateGE 3
		DO: SetState {CheckForTownNetworkDrop}
~~ }
STATE: {AttemptPrimaryRecallToTownNetwork} ~~ {
	IF: Always
		DO: EmbedNav nav4 {PrimaryRecall.nav}
	IF: All
			ExitPortal
			BlockE 00070000
		DO: SetState {CheckForTownNetworkDrop}
	IF: All
			ExitPortal
			Not BlockE 00070000
		DO: SetState {AttemptSecondaryRecallToTownNetwork}
~~ }
STATE: {AttemptSecondaryRecallToTownNetwork} ~~ {
	IF: Always
		DO: EmbedNav nav5 {SecondaryRecall.nav}
	IF: All
			ExitPortal
			BlockE 00070000
		DO: SetState {CheckForTownNetworkDrop}
	IF: All
			ExitPortal
			Not BlockE 00070000
		DO: DoAll
				DoExpr {echo[Could not get to Town Network via recalls\! Aborting,15]}
				SetState {CouldNotReachTownNetwork}
~~ }
STATE: {NavigatingToWoodshoreCottages} ~~ {
	IF: Always
		DO: EmbedNav nav0 {TownNetworktoWoodshoreCottages.nav}
	IF: All
			NavEmpty
			SecsInStateGE 3
		DO: SetState {GroupUp}
~~ }
STATE: {GroupUp} ~~ {
	IF: ItemCountLE 0 {Egg}
		DO: SetState {WaitingForLeader}
	IF: ItemCountGE 1 {Egg}
		DO: CallState {VerifyGroup} {NavigatingToDaimyoIdahCheck}
~~ }
STATE: {WaitingForLeader} ~~ {
	IF: ChatMatch {Fellowship present} ~~ this could be a more robust regex
		DO: SetState {NavigatingToDaimyoIdahCheck}
~~ }
STATE: {VerifyGroup} ~~ {
~~ this is a subroutine state used by CallState
	IF: Always
		DO: DoExpr {setvar[closeChars,listmap[wobjectfindallbyobjectclass[24],`setvar[dt,coordinatedistancewithz[getplayercoordinates[],wobjectgetphysicscoordinates[$1]]];iif[getvar[dt]<5,wobjectgetstringprop[$1,1],0]`]]}
	IF: All 
			SecsInStateGE 2
			Expr {listcount[listfilter[getfellownames[],`listcontains[getvar[closeChars],$1]`]]==listcount[getfellownames[]]}
		DO: Chat {/f Fellowship all detected, waiting to ensure all exit portalspace}
	IF: All 
			SecsInStateGE 20
			Expr {listcount[listfilter[getfellownames[],`listcontains[getvar[closeChars],$1]`]]==listcount[getfellownames[]]}
		DO: DoAll
				Chat {/f Fellowship present}
				Return
	IF: All 
			SecsInStateGE 2
			Expr {listcount[listfilter[getfellownames[],`listcontains[getvar[closeChars],$1]`]]!=listcount[getfellownames[]]} 
		DO: Chat {/f Awaiting fellowship, pausing 15 seconds}
	IF: SecsInStateGE 21
		DO: SetState {VerifyGroup}
~~ }
STATE: {NavigatingToDaimyoIdahCheck} ~~ {
	IF: Always
		DO: EmbedNav nav7 {WoodshoreCottagesToDaimyoIdahCheck.nav}
	IF: All
			NavEmpty
			SecsInStateGE 3
		DO: SetState {DaimyoCheck}
~~ }
STATE: {DaimyoCheck} ~~ {
	IF: Expr {listcount[wobjectfindalllandscapebynamerx[`Daimyo Idah`]]==1}
		DO: DoAll
				DoExpr {vtsetsetting[EnableCombat,`1`]}
				Chat {/f Daimyo Idah detected. Switching to player control.  Meta complete.}
				SetState {End}
	IF: Expr {listcount[wobjectfindalllandscapebynamerx[`Daimyo Idah`]]==0}
		DO: DoAll
				Chat {/f Daimyo Idah not found.}
				SetState {LifestoneRecall}
~~ }
STATE: {LifestoneRecall} ~~ {
	IF: Always
		DO: EmbedNav nav8 {LifestoneRecall.nav}
	IF: All
			NavEmpty
			SecsInStateGE 3
		DO: SetState {GroupUpLandblock} ~~ group up before waiting for landblock to ensure all are out
~~ }
STATE: {WaitingForLandblockReset} ~~ {
	IF: SecsInStateGE 300 ~~ 5 minute landblock reset
		DO: SetState {NightTimeCheck}
~~ }
STATE: {GroupUpLandblock} ~~ {
	IF: ItemCountLE 0 {Egg}
		DO: SetState {WaitingForLeaderLandblock}
	IF: ItemCountGE 1 {Egg}
		DO: CallState {VerifyGroup} {WaitingForLandblockReset}
~~ }
STATE: {WaitingForLeaderLandblock} ~~ {
	IF: ChatMatch {Fellowship present} ~~ this could be a more robust regex
		DO: SetState {WaitingForLandblockReset}
~~ }
STATE: {End} ~~ {
	IF: All 
			SecsInStateGE 5
			Expr {testgvar[defaultMeta]==1}
		DO: ChatExpr {\/vt meta load +getgvar[defaultMeta]}
~~ }


~~========================= ONLY NAVS APPEAR BELOW THIS LINE =========================~~

NAV: nav0 once ~~ {
	pnt -101.658333333333 -96.6833333333333 2.08333134651184E-05
	pnt -101.698234001795 -96.6402236620585 2.08333134651184E-05
	pnt -101.658945465088 -96.5958399295807 2.08333134651184E-05
	pnt -101.657305590312 -96.5652097860972 2.08333134651184E-05
	pnt -101.657397492727 -96.5216979503632 2.08333134651184E-05
	pnt -101.650072383881 -96.4863263448079 2.08333134651184E-05
	pnt -101.640186659495 -96.4539040565491 2.08333134651184E-05
	pnt -101.62797609965 -96.4138570388158 2.08333134651184E-05
	pnt -101.617224343618 -96.3806505362193 2.08333134651184E-05
	ptl -20.1762404600779 69.6284050305684 0.316661135355632 -101.616920820872 -96.3639541665713 -0.000262499845121056 14 {Stonehold Portal}
	pnt -21.8062452952067 68.6534700075785 0.325020853678385
	pnt -21.7300077120463 68.649099334081 0.325020853678385
	pnt -21.6544348398844 68.6441582838694 0.325020853678385
	pnt -21.5775685628255 68.642711353302 0.325020853678385
	pnt -21.5327639579773 68.6447999954224 0.325020853678385
	pnt -21.4902037938436 68.6470347722371 0.325020853678385
	pnt -21.4600409507751 68.66878490448 0.325020853678385
	pnt -21.4082172393799 68.7113314946493 0.325020853678385
	pnt -21.3460992177327 68.738041305542 0.323720582326253
	pnt -21.2879193623861 68.7565038363139 0.304327297210693
	pnt -21.2284554163615 68.7749830245972 0.29764674504598
	pnt -21.1563512166341 68.8157201449076 0.305497487386068
	pnt -21.0589741388957 68.871944586436 0.318516222635905
	pnt -20.9419624169668 68.9357487042745 0.338276672363281
	pnt -20.8481823285421 68.9944180806478 0.366211605072022
	pnt -20.7803939183553 69.0414842605591 0.391003068288167
	pnt -20.7449884414673 69.0698012669881 0.401253318786621
	pnt -20.6859946886698 69.1280675252279 0.401192696889242
	pnt -20.6420931180318 69.1714274724325 0.392878341674805
	pnt -20.5918277740479 69.221072769165 0.376329898834229
	pnt -20.5396633783976 69.2725939234098 0.359857527414958
	pnt -20.5000668207804 69.311702187856 0.349583117167155
	pnt -20.4642744700114 69.3431688070297 0.323000462849935
	pnt -20.429713567098 69.3683768908183 0.312252394358317
	pnt -20.3988217671712 69.3976184686025 0.305079523722331
	pnt -20.3758714675903 69.4263625303904 0.297596867879232
	pnt -20.3521840413411 69.4703951517741 0.289987881978353
	pnt -20.3295715113481 69.5124402999878 0.28988889058431
	pnt -20.3247275789579 69.5152722835541 0.290460236867269
	pnt -20.3016618251801 69.5273297309875 0.291160742441813
	pnt -20.2757504940033 69.5433265686035 0.290653864542643
	pnt -20.2525610208511 69.5610902786255 0.292184861501058
	pnt -20.2286655426025 69.5800166447957 0.299522495269775
	pnt -20.2088991800944 69.598783047994 0.306027952829997
	pnt -20.1873879114787 69.6188411076864 0.313077290852865
	pnt -20.1762404600779 69.6284050305684 0.316661135355632
	ptl -20.1762404600779 69.6284050305684 0.316661135355632 -20.1611983299255 69.6343262354533 0.321004748344421 14 {Woodshore Cottages Portal}
~~ }
NAV: nav1 once ~~ {
	pnt -101.657279141744 -96.6906586329142 2.08333134651184E-05
~~ }
NAV: nav2 once ~~ {
	pnt -101.613241004944 -96.6465869903564 2.08333134651184E-05
	pnt -101.657922903697 -96.6921284039815 2.08333134651184E-05
~~ }
NAV: nav3 once ~~ {
	pnt -101.657663281759 -96.6933292071025 2.08333134651184E-05
~~ }
NAV: nav4 once ~~ {
	rcl -101.657922903697 -96.6921284039815 2.08333134651184E-05 {Primary Portal Recall}
~~ }
NAV: nav5 once ~~ {
	rcl -101.657922903697 -96.6921284039815 2.08333134651184E-05 {Secondary Portal Recall}
~~ }
NAV: nav7 once ~~ {
	pnt -44.2251263777415 77.8255108515421 0.168792343139648
	pnt -44.1508819103241 77.8388475418091 0.181421931584676
	pnt -44.1130114396413 77.8365361531576 0.182232189178467
	pnt -44.0518063863118 77.8282285054525 0.181539885203044
	pnt -44.0136479059855 77.8224803288778 0.187119547526042
	pnt -43.9627047538757 77.8148459752401 0.19310310681661
	pnt -43.9225852012634 77.8092564900716 0.193230247497559
	pnt -43.8732365926107 77.8227340062459 0.195476500193278
	pnt -43.8335854212443 77.8498922348022 0.198634990056356
	pnt -43.7925525665283 77.8752026875814 0.195233551661174
	pnt -43.749786567688 77.8780729929606 0.194026915232341
	pnt -43.6957648595174 77.8774937311808 0.193978643417358
	pnt -43.6051039377848 77.876521619161 0.19015630086263
	pnt -43.5496006011963 77.8759265263875 0.185481437047323
	pnt -43.4988981644313 77.8753828684489 0.183354171117147
	pnt -43.4752640962601 77.8826824824015 0.183354171117147
	pnt -43.4246213833491 77.8948980331421 0.181239287058512
	pnt -43.3844808419545 77.8889434814453 0.178266127904256
	pnt -43.3308537801107 77.8747519175212 0.178679021199544
	pnt -43.2837078253428 77.8620758056641 0.181551504135132
	pnt -43.2320503870646 77.8483578364054 0.183491023381551
	pnt -43.191291586558 77.8377340316772 0.184376335144043
	pnt -43.1488508542379 77.8269638697306 0.187385050455729
	pnt -43.1082419077555 77.8169284820557 0.195101896921794
	pnt -43.0747511227926 77.799076016744 0.202355909347534
	pnt -43.0414461135864 77.780224386851 0.209844239552816
	pnt -42.9938324610392 77.7679125785828 0.216889985402425
	pnt -42.9555648167928 77.7704268455505 0.219450394312541
	pnt -42.910671933492 77.7789675712585 0.223470242818197
	pnt -42.8631924947103 77.7853876749675 0.226356840133667
	pnt -42.8223532358805 77.7866015116374 0.229557816187541
	pnt -42.7565516789754 77.7885573069255 0.234715302785238
	pnt -42.7075087388356 77.7881286621094 0.238873672485352
	pnt -42.6589001655579 77.7824289004008 0.243874343236287
	pnt -42.601876115799 77.7740749994914 0.250018660227458
	pnt -42.5562533537547 77.762552801768 0.255740928649902
	pnt -42.507842652003 77.7453133583069 0.259135278065999
	pnt -42.4583907763163 77.7388205846151 0.260217396418254
	pnt -42.4138712565104 77.7242268244425 0.26479746500651
	pnt -42.3720945040385 77.7015977859497 0.27045472462972
	pnt -42.329062016805 77.6832513491313 0.276786168416341
	pnt -42.2849013010661 77.6688185373942 0.284074433644613
	pnt -42.2461318333944 77.6587297757467 0.290149784088135
	pnt -42.2028195063273 77.6493274688721 0.299663003285726
	pnt -42.1632738749186 77.6451327323914 0.306953080495199
	pnt -42.1428339004517 77.6467908541361 0.312944602966309
	pnt -42.1066617965698 77.657493686676 0.324538326263428
	pnt -42.0688302357992 77.6701033910116 0.336936887105306
	pnt -42.0262431462606 77.6779602050781 0.344309997558594
	pnt -41.9929164886475 77.6887280464172 0.35274387995402
	pnt -41.9405635307233 77.7086888631185 0.365613174438477
~~ }
NAV: nav8 once ~~ {
	rcl 56.8844753265381 33.6273729642232 0.175020837783813 {Lifestone Recall}
~~ }


